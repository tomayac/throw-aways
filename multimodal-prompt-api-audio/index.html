<meta http-equiv="origin-trial" content="/nFWiZTQ2hg+TyPStWls6AyOMWEsd+U/xL6OOEegILTNKLvz6L0b4Jkc2JPheOiT/8yD2pfW14YWAoAAABqeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZWNocm9tZS5naXRodWIuaW86NDQzIiwiZmVhdHVyZSI6IkFJUHJvbXB0QVBJTXVsdGltb2RhbElucHV0IiwiZXhwaXJ5IjoxNzc0MzEwNDAwfQ==">
<audio controls preload="auto"><source src="hello.mp3" /></audio>
<button id="button" type="button">Transcribe</button>
<output id="output"></output>
<script type="module">
  button.addEventListener('click', async () => {
    const blob = await fetch('hello.mp3').then((response) => response.blob());
    output.textContent = '';
    const session = await LanguageModel.create({
      expectedInputs: [{ type: 'audio' }, { type: 'text', languages: ['en'] }],
      expectedOutputs: [{ type: 'text', languages: ['en'] }],
    });
    const stream = session.promptStreaming([
      {
        role: 'user',
        content: [
          {
            type: 'audio',
            value: blob,
          },

          {
            type: 'text',
            value: 'Transcribe this audio file.',
          },
        ],
      },
    ]);
    for await (const chunk of stream) {
      output.append(chunk);
    }
  });
</script>
